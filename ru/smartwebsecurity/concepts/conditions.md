# Условия

Вы можете задать следующие условия для [правил](rules.md):

#|
|| **Тип** | **Виды сопоставления** | **Значения** | **Пример** | **Логический оператор** ||
|| `{{ ui-key.yacloud.smart-web-security.overview.condition_name-ip-range }}` |
* Совпадает или принадлежит диапазону
* Не совпадает и не принадлежит диапазону
* IP принадлежит региону
* IP не принадлежит региону
|
* IP-адрес
* [CIDR](https://ru.wikipedia.org/wiki/Бесклассовая_адресация)
* Диапазон адресов
* Двухбуквенный код страны по [ISO 3166-1 alpha-2](https://ru.wikipedia.org/wiki/ISO_3166-1_alpha-2)
|
* `1.2.33.44`
* `2001:0db8:85a3:0000:0000:8a2e:0370:7334`
* `10::1234:1abc:1/64`
* `1.2.0.0-1.2.1.1`
* `ru`
* `kz`
| _или_ ||
|| `{{ ui-key.yacloud.smart-web-security.overview.condition_name-header }}` |
* Совпадает с
* Не совпадает с
* Начинается с
* Не начинается с
* Соответствует регулярному выражению
* Не соответствует регулярному выражению
|
Формат `ключ: значение`, где ключ — HTTP-заголовок,
значение — конкретное значение заголовка, префикс 
значения или [регулярное выражение](https://ru.wikipedia.org/wiki/Регулярные_выражения) библиотеки
[PIRE](https://github.com/yandex/pire)
|
* `User-Agent: curl/7.55.1`
| _и_ ||
|| `{{ ui-key.yacloud.smart-web-security.overview.condition_name-requestUri }}` |
* Совпадает с
* Не совпадает с
* Начинается с
* Не начинается с
* Соответствует регулярному выражению
* Не соответствует регулярному выражению
| 
Путь запроса, начало пути запроса или регулярное
выражение библиотеки PIRE
|
* `/`
| _Не применяется_ ||
|| `Query Match` |
* Совпадает с
* Не совпадает с
* Начинается с
* Не начинается с
* Соответствует регулярному выражению
* Не соответствует регулярному выражению
|
Формат `ключ: значение`, где ключ — параметр 
запроса, значение — конкретное значение параметра,
префикс значения или регулярное выражение библиотеки
PIRE
|  
* `a: 1`
* `A: 2`
| _и_ ||
|| `{{ ui-key.yacloud.smart-web-security.overview.condition_name-authority }}` |
* Совпадает с
* Не совпадает с
* Начинается с
* Не начинается с
* Соответствует регулярному выражению
* Не соответствует регулярному выражению
|
Значения заголовка `Host` для HTTP/1.1 или 
псевдозаголовка `authority` для HTTP/2, по которому
выбирается виртуальный хост, префикс значения или 
регулярное выражение библиотеки PIRE
|
* `example.com`
| _или_ ||
|| `{{ ui-key.yacloud.smart-web-security.overview.condition_name-httpMethod }}` |
* Совпадает с
* Не совпадает с
* Начинается с
* Не начинается с
* Соответствует регулярному выражению
* Не соответствует регулярному выражению
|
[Метод HTTP-запроса](https://ru.wikipedia.org/wiki/HTTP#Методы) в верхнем регистре,
допускается произвольное значение, префикс значения
или регулярное выражение библиотеки PIRE
|
* `GET`
* `POST`
* `DELETE`
| _или_ ||
|#